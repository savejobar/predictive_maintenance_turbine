# Predictive Maintenance Turbine (Python)

## Описание

Данный репозиторий содержит реализацию ML-проекта по построению модели машинного обучения для **предсказания состояния работы крутильного вала турбоагрегата в режиме реального времени**.

Проект основан на исторических данных работы турбины и демонстрирует полный цикл:

- предобработки временных данных  
- построения признаков для временного ряда  
- обучения модели **LightGBM**  
- оценки качества  
- моделирования мониторинга в реальном времени (*итеративный прогноз*)

**Цель проекта** — создать основу для предиктивной системы мониторинга турбоагрегатов, которая позволит **заранее выявлять критические режимы работы** и снижать риск аварийных ситуаций.

**Используемые технологии:** Python, Pandas, NumPy, SciPy, scikit-learn, LightGBM, Optuna, Matplotlib, Jupyter Notebook

---

## Контекст и предметная область

Контроль валопроводов турбоагрегатов по крутильным колебаниям является важной задачей для электростанций (мощность установок может достигать *1200 МВт*).

Данный проект рассматривает применение методов машинного обучения для:

- прогнозирования критических ситуаций  
- выявления опасных отклонений физических параметров  
- подготовки архитектуры системы мониторинга, архивирования и переобучения модели  

---

## Данные

Источник данных:

- `Prism_МоДеРо.xlsx`

Характеристики:

- год: **2016**
- частота измерений: **1 час**
- количество записей: **6679**
- количество признаков: **16 режимных параметров**
- целевая переменная: **F1**
- тип признаков: действительные значения (*температуры, давления, частоты и др.*)

---

## Рассматриваемая задача

### Тип задачи

- регрессия по временным данным (*time series regression*)

### Целевая переменная

- прогноз параметра **F1** (*крутильные колебания*)

### Особенности постановки

- строгий временной порядок данных  
- запрет утечек информации из будущего  
- ориентация на использование в мониторинге реального времени  

---

## Используемый подход

Для учета временной динамики временного ряда применяется генерация признаков.

### Временные признаки

- час, день недели, день месяца, месяц  
- циклическое кодирование через `sin/cos` преобразования  

### Лаговые признаки

- лаги **1–24 часа**
- расширенные лаги **72 и 168 часов**

### Скользящие статистики

Для окон **6, 12, 24, 72 часа**:

- rolling mean / median  
- rolling std  
- rolling min / max  
- rolling sum  

### Экспоненциальное сглаживание

- EWMA признаки с разными коэффициентами сглаживания  

### Разности лагов (*delta features*)

- разности между соседними лагами  
  `lag_i - lag_(i-1)`

### Полиномиальные признаки

- признаки 2-го порядка на основе лагов и delta-лагов  

---

## Модель

### LightGBM (LGBMRegressor)

Причины выбора:

- высокая скорость обучения и инференса  
- устойчивость к выбросам и пропускам (*типично для промышленных данных*)  
- способность моделировать нелинейные зависимости  
- эффективная работа на признаках вида *lag / rolling / time*  

---

## Подбор гиперпараметров

### Optuna

Оптимизируются ключевые параметры:

- boosting type
- learning rate  
- max depth  
- num leaves  
- L2 regularization  
- subsample / feature fraction  
- количество деревьев  

---

## Оценка качества

Метрики на тестовой выборке:

- **MAPE:** 0.02344%
- **MAE:** 0.00453
- **MSE:** 0.00004

Также выполняется:

- сравнение прогнозов и факта на недельном интервале  
- анализ важности и отбор признаков (*feature importance*)  
- моделирование мониторинга (*итеративный прогноз*)  

---

## Моделирование мониторинга в реальном времени

Реализован сценарий, приближенный к реальной эксплуатации:

- прогноз строится на горизонт **24 часа**
- каждый следующий шаг использует предыдущие значения ряда  
- для будущих точек используются **предыдущие предсказания**, а не реальные значения  

Это имитирует работу предиктивной системы в условиях отсутствия доступа к будущим данным.

---

## Архитектура предиктивной системы (*концепт*)

Предиктивная система проектируется как связка двух подсистем:

### 1) Подсистема хранения данных (*DB-контур*)

Отвечает за:

- архивирование данных от турбины  
- сохранение прогнозов  
- хранение метрик качества  
- обработку пользовательских запросов (*графики, аналитика*)  

### 2) ML-оболочка

Отвечает за:

- получение данных в реальном времени  
- формирование признаков  
- прогнозирование F1  
- переобучение модели с заданной частотой  
- выдачу результатов в DB или пользователю  

---

## Структура проекта

```text
predictive_maintenance_turbine/
│
├─ service/
│  ├─ artifacts/              # артефакты обучения: используемые фичи, гиперпараметры
│  └─ models/                 # сохраненная модель
│
├─ boosting_experiment.ipynb  # эксперименты, графики, анализ ACF/PACF, мониторинг
├─ features.py                # генерация признаков (lags, rolling, time features)
├─ training.py                # обучение модели + optuna + оценка + сохранение
├─ utils.py                   # утилиты: графики, нахождение интервалов пропусков
│
├─ Prism_МоДеРо.xlsx          # исходные исторические данные
├─ Пояснительная записка.pdf  # отчет проекта
├─ Презентация.pdf            # презентация проекта
│
├─ LICENSE
└─ .gitignore
